<project name="xwork" default="jar" basedir=".">
    <!-- overridden properties (must be before the import!) -->
    <property name="src.test" value="src/test"/>

    <import file="osbuild.xml"/>

    <target name="init" depends="common.init">
        <taskdef name="ivy-configure" classname="fr.jayasoft.ivy.ant.IvyConfigure"/>
        <taskdef name="ivy-resolve" classname="fr.jayasoft.ivy.ant.IvyResolve"/>
        <taskdef name="ivy-retrieve" classname="fr.jayasoft.ivy.ant.IvyRetrieve"/>
        <taskdef name="ivy-publish" classname="fr.jayasoft.ivy.ant.IvyPublish"/>
        <taskdef name="ivy-report" classname="fr.jayasoft.ivy.ant.IvyReport"/>
        <taskdef name="ivy-deliver" classname="fr.jayasoft.ivy.ant.IvyDeliver"/>

        <ivy-retrieve/>
    </target>

    <target name="ivyrep.copy-ivy" depends="init">
        <ivy-deliver deliverpattern="${ivyrep.path}/opensymphony/${name}/[artifact]-[revision].[ext]"
                     pubrevision="${version}-${TIME}" pubdate="${TIME}"/>
    </target>

    <target name="compile" depends="common.compile">
        <compile srcdir="tiger/src/java" destdir="tiger/build/java" classpath="${build.java}" source="1.5"
                 target="1.5"/>
    </target>

    <target name="predist">
        <!-- build up xwork-tiger jar -->
        <jar destfile="dist/${name}-tiger-${version}.jar">
            <fileset dir="tiger/build/java"/>
        </jar>
    </target>

    <target name="jar" depends="common.jar">
        <jar basedir="${src.java}" jarfile="${build}/${name}-${version}-src.jar">
            <manifest>
                <attribute name="Implementation-Title" value="${fullname}"/>
                <attribute name="Implementation-Version" value="${version}"/>
            </manifest>
        </jar>
    </target>

    <target name="docs.impl" depends="common.docs.impl">
        <copy todir="${dist.docs}">
            <fileset dir="${src.java}" includes="*.dtd"/>
        </copy>
    </target>

    <target name="ivyrep" depends="common.ivyrep">
        <antcall target="common.ivyrep">
            <param name="name" value="${name}-tiger"/>
        </antcall>
    </target>
</project>
