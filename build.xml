<project name="xwork" default="jar" basedir=".">
    <!-- overridden properties (must be before the import!) -->
    <property name="src.test" value="src/test"/>

    <import file="osbuild.xml"/>

    <target name="init" depends="common.init" unless="skip.ivy">
        <taskdef name="ivy-configure" classname="fr.jayasoft.ivy.ant.IvyConfigure"/>
        <taskdef name="ivy-resolve" classname="fr.jayasoft.ivy.ant.IvyResolve"/>
        <taskdef name="ivy-retrieve" classname="fr.jayasoft.ivy.ant.IvyRetrieve"/>
        <taskdef name="ivy-publish" classname="fr.jayasoft.ivy.ant.IvyPublish"/>
        <taskdef name="ivy-report" classname="fr.jayasoft.ivy.ant.IvyReport"/>
        <taskdef name="ivy-deliver" classname="fr.jayasoft.ivy.ant.IvyDeliver"/>

        <ivy-retrieve/>
    </target>

    <target name="ivyrep.copy-ivy" depends="init" unless="noivyxml">
        <ivy-deliver deliverpattern="${ivyrep.path}/opensymphony/${name}/[artifact]-[revision].[ext]"
                     pubrevision="${version}-${TIME}" pubdate="${TIME}"/>
    </target>

    <target name="compile" depends="common.compile">
    </target>

    <target name="predist" depends="tiger">
        <copy file="%{build}/${name}-tiger-${version}.jar" todir="${dist}"/>
    </target>

    <target name="tiger">
        <compile srcdir="tiger/src/java" destdir="tiger/build/java" classpath="${build.java}" source="1.5"
                 target="1.5"/>

        <jar destfile="${build}/${name}-tiger-${version}.jar">
            <fileset dir="tiger/build/java"/>
        </jar>

        <jar destfile="${build}/${name}-tiger-src-${version}.jar">
            <fileset dir="tiger/src/java"/>
        </jar>
    </target>

    <target name="docs.impl" depends="common.docs.impl">
        <copy todir="${dist.docs}">
            <fileset dir="${src.java}" includes="*.dtd"/>
        </copy>
    </target>

    <target name="ivyrep" depends="common.ivyrep">
        <antcall target="ivyrep.impl" inheritrefs="no" inheritall="no">
            <param name="name" value="${name}-tiger"/>
            <param name="noivyxml" value="yes"/>
        </antcall>
    </target>
</project>