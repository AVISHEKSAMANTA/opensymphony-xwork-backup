<html>
    <head>
        <title>XWork - 
        Sample Validation Rules
         </title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <p>In this example, we have an Action that attempts to fill the values of a User object.  The first validation file would be for a a simple Action that had a "user" property.  The second validation file is for the exact same Action if it had implemented the ModelDriven interface and exposed the User object via <b>getModel()</b> instead of <b>getUser()</b>.  Both of them uses the VisitorFieldValidator to use the User object's own validation rules to validate the User object, which can be found in the third validation file.</p>

<p>Notice that the <em>short-circuit</em> attribute of the <b>field-validator</b> element is used in several places to prevent subsequent validators from running.  This is useful in preventing multiple error messages when one will do.  For example, if the value provided for the User's startDate cannot be parsed as a date, display the appropriate message and don't even bother checking that it is in the correct range.</p>

<p><br clear="all" />
SampleAction-validation.xml:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"user"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"required"</span>  short-circuit=<span class="code-quote">"true"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>You must provide a user.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"visitor"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"context"</span>&gt;</span>anotherContext<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>user: <span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

<p><br clear="all" />
SampleModelDrivenAction-validation.xml:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"model"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"visitor"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"appendPrefix"</span>&gt;</span>false<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message /&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

<p><br clear="all" />
User-validation.xml:</p>
<div class="code"><div class="codeContent">
<pre class="code-xml"><span class="code-tag">&lt;validators&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"userName"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"requiredstring"</span> short-circuit=<span class="code-quote">"true"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>You must enter an username.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"stringlength"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"minLength"</span>&gt;</span>3<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"maxLength"</span>&gt;</span>10<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>Username must be between ${minLength} and ${maxLength} characters long.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"email"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"email"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>You must enter a valid email address.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
     <span class="code-tag">&lt;field name=<span class="code-quote">"homepage"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"url"</span> short-circuit=<span class="code-quote">"true"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>You must enter a valid URL.<span class="code-tag">&lt;/message&gt;</span>            
        <span class="code-tag">&lt;/field-validator&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"fieldexpression"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"expression"</span>&gt;</span>homepage.indexOf('opensymphony.com') == -1<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>Please provide an OpenSymphony website<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"age"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"int"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>0<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"max"</span>&gt;</span>100<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>Not a valid age!<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
    <span class="code-tag">&lt;field name=<span class="code-quote">"startDate"</span>&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"conversion"</span> short-circuit=<span class="code-quote">"true"</span>&gt;</span>
            <span class="code-tag">&lt;validator type=<span class="code-quote">"startDate"</span>&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>Could not convert input to a valid date.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
        <span class="code-tag">&lt;field-validator type=<span class="code-quote">"date"</span>&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"min"</span>&gt;</span>12/22/2002<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;param name=<span class="code-quote">"max"</span>&gt;</span>12/25/2002<span class="code-tag">&lt;/param&gt;</span>
            <span class="code-tag">&lt;message&gt;</span>The date must be between 12-22-2002 and 12-25-2002.<span class="code-tag">&lt;/message&gt;</span>
        <span class="code-tag">&lt;/field-validator&gt;</span>
    <span class="code-tag">&lt;/field&gt;</span>
<span class="code-tag">&lt;/validators&gt;</span></pre>
</div></div>

                    			    </td>
		    </tr>
	    </table>
    </body>
</html>
